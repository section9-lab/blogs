import{_ as d}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as p,c as u,d as a,b as s,w as e,e as n,f as t}from"./app-f72abdb6.js";const m="/blogs/assets/docker-on-linux-2fec43bd.png",k="/blogs/assets/docker-flow-0d9b1c5d.png",v={},b=a("h1",{id:"docker",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#docker","aria-hidden":"true"},"#"),n(" Docker")],-1),h={class:"table-of-contents"},f=t('<hr><h1 id="docker-1" tabindex="-1"><a class="header-anchor" href="#docker-1" aria-hidden="true">#</a> Docker</h1><h2 id="_1、docker是什么" tabindex="-1"><a class="header-anchor" href="#_1、docker是什么" aria-hidden="true">#</a> 1、Docker是什么？</h2><p>Docker 基于 Linux 内核的 cgroup，namespace，以及 OverlayFS 类的 Union FS 等技术，对进程进行封装隔离，属于 操作系统层面的虚拟化技术。<br> 由于隔离的进程独立于宿主和其它的隔离的进程，因此也称其为容器。</p><figure><img src="'+m+'" alt="架构" tabindex="0" loading="lazy"><figcaption>架构</figcaption></figure><p>Docker 在容器的基础上，进行了进一步的封装，从文件系统、网络互联到进程隔离等等，极大的简化了容器的创建和维护。<br> 使得 Docker 技术比虚拟机技术更为轻便、快捷。</p><figure><img src="'+k+'" alt="运行流程" tabindex="0" loading="lazy"><figcaption>运行流程</figcaption></figure><h2 id="_2、docker解决了什么问题" tabindex="-1"><a class="header-anchor" href="#_2、docker解决了什么问题" aria-hidden="true">#</a> 2、Docker解决了什么问题？</h2><h3 id="_2-1、在docker诞生之前存在什么问题" tabindex="-1"><a class="header-anchor" href="#_2-1、在docker诞生之前存在什么问题" aria-hidden="true">#</a> 2.1、在Docker诞生之前存在什么问题？</h3><ul><li>没有版本控制，每次上线前要对老包备份。</li><li>没有统一配置，集群里各个硬件节点规格不一样。</li><li>没有统一的环境，dev环境和test环境和prod环境不一样。</li><li>没有隔离，ES和Redis、kafka运行在一起，抢占资源。</li><li>无法移植。</li></ul><h3 id="_2-2、docker的优点" tabindex="-1"><a class="header-anchor" href="#_2-2、docker的优点" aria-hidden="true">#</a> 2.2、Docker的优点：</h3><ul><li>更高效的利用系统资源</li></ul><blockquote><p>Docker 容器不需硬件虚拟和运行操作系统的开销,因此在同等配置下,主机可以运行更多数量的应用。</p></blockquote><ul><li>更快速的启动时间</li></ul><blockquote><p>Docker 容器直接运行于宿主机内核,避免启动完整操作系统,从而实现秒级甚至毫秒级的应用启动。</p></blockquote><ul><li>一致的运行环境</li></ul><blockquote><p>Docker 镜像提供除内核外完整的运行环境,确保从开发到生产的环境一致性,避免了「代码在我机器上没问题」这类问题的出现。</p></blockquote><ul><li>持续交付和部署</li></ul><blockquote><p>对开发和运维人员来说,Docker 可以通过制作应用镜像,实现从持续集成到持续交付及自动化部署,整个过程透明且高效。</p></blockquote><ul><li>更轻松的迁移</li></ul><blockquote><p>Docker 容器化应用执行环境,使应用迁移到任意平台时环境一致、顺利运行。</p></blockquote><ul><li>更轻松的维护和扩展</li></ul><blockquote><p>Docker 利用分层存储和镜像技术,使应用复用、维护和定制变得简单高效,配合优质官方镜像,可直接用于生产或定制使用,大幅降低应用镜像制作成本。</p></blockquote><h2 id="_3、安装docker" tabindex="-1"><a class="header-anchor" href="#_3、安装docker" aria-hidden="true">#</a> 3、安装docker</h2><p>docker_install.sh</p>',25),g=a("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token shebang important"},"#!/usr/bin/bash"),n(`
 
`),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"apt-get"),n(" remove "),a("span",{class:"token function"},"docker"),n(`
`),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"apt-get"),n(` remove docker-engine
`),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"apt-get"),n(` remove docker.io
`),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"apt-get"),n(` update
`),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"apt-get"),n(),a("span",{class:"token function"},"install"),n(" apt-transport-https ca-certificates "),a("span",{class:"token function"},"curl"),n(" gnupg lsb-release "),a("span",{class:"token parameter variable"},"-y"),n(`
`),a("span",{class:"token function"},"curl"),n(),a("span",{class:"token parameter variable"},"-fsSL"),n(" https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg "),a("span",{class:"token operator"},"|"),n(),a("span",{class:"token function"},"sudo"),n(" gpg "),a("span",{class:"token parameter variable"},"--dearmor"),n(),a("span",{class:"token parameter variable"},"-o"),n(` /usr/share/keyrings/docker-archive-keyring.gpg
`),a("span",{class:"token builtin class-name"},"echo"),n(),a("span",{class:"token string"},[n('"deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu  '),a("span",{class:"token variable"},[a("span",{class:"token variable"},"$("),n("lsb_release "),a("span",{class:"token parameter variable"},"-cs"),a("span",{class:"token variable"},")")]),n(' stable"')]),n(),a("span",{class:"token operator"},"|"),n(),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"tee"),n(" /etc/apt/sources.list.d/docker.list "),a("span",{class:"token operator"},">"),n(` /dev/null
`),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"apt-get"),n(` update
`),a("span",{class:"token function"},"sudo"),n(),a("span",{class:"token function"},"apt-get"),n(),a("span",{class:"token function"},"install"),n(" docker-ce docker-ce-cli containerd.io "),a("span",{class:"token parameter variable"},"-y"),n(`

`),a("span",{class:"token function"},"sudo"),n(" systemctl "),a("span",{class:"token builtin class-name"},"enable"),n(),a("span",{class:"token function"},"docker"),n(`
`),a("span",{class:"token function"},"sudo"),n(" systemctl start "),a("span",{class:"token function"},"docker"),n(`
`)])]),a("div",{class:"line-numbers","aria-hidden":"true"},[a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"})])],-1),_=a("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token shebang important"},"#!/usr/bin/bash"),n(`

yum `),a("span",{class:"token parameter variable"},"-y"),n(` update
yum remove `),a("span",{class:"token function"},"docker"),n("  docker-client "),a("span",{class:"token punctuation"},"\\"),n(`
docker-client-latest docker-common `),a("span",{class:"token punctuation"},"\\"),n(`
docker-latest docker-latest-logrotate `),a("span",{class:"token punctuation"},"\\"),n(`
docker-logrotate docker-engine

yum `),a("span",{class:"token function"},"install"),n(),a("span",{class:"token parameter variable"},"-y"),n(` yum-utils device-mapper-persistent-data lvm2
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
yum `),a("span",{class:"token function"},"install"),n(),a("span",{class:"token parameter variable"},"-y"),n(` docker-ce docker-ce-cli containerd.io docker-compose-plugin

systemctl `),a("span",{class:"token builtin class-name"},"enable"),n(` docker.service
systemctl restart `),a("span",{class:"token function"},"docker"),n(`
`)])]),a("div",{class:"line-numbers","aria-hidden":"true"},[a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"}),a("div",{class:"line-number"})])],-1),x=t(`<h2 id="_4、docker命令" tabindex="-1"><a class="header-anchor" href="#_4、docker命令" aria-hidden="true">#</a> 4、docker命令</h2><h3 id="_4-1、image" tabindex="-1"><a class="header-anchor" href="#_4-1、image" aria-hidden="true">#</a> 4.1、image</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#查看服务器中docker 镜像列表：</span>
<span class="token function">docker</span> images

<span class="token comment">#搜索镜像：</span>
<span class="token function">docker</span> search <span class="token punctuation">[</span>镜像名<span class="token punctuation">]</span>

<span class="token comment">#拉取镜像：</span>
<span class="token function">docker</span> pull 镜像名 
<span class="token function">docker</span> pull 镜像名:tag

<span class="token comment">#运行镜像:</span>
<span class="token function">docker</span> run 镜像名
<span class="token function">docker</span> run 镜像名:Tag
<span class="token function">docker</span> stop containerId // containerId 是容器的ID

<span class="token comment">#修改镜像：</span>
<span class="token function">docker</span> <span class="token function">ps</span>
<span class="token function">docker</span> commit x7205xxxxxx1 sequenceiq/hadoop-docker:2.7.0-7

<span class="token comment">#删除一个</span>
<span class="token function">docker</span> rmi <span class="token parameter variable">-f</span> 镜像名/镜像ID

<span class="token comment">#删除全部镜像  -a 意思为显示全部, -q 意思为只显示ID</span>
<span class="token function">docker</span> rmi <span class="token parameter variable">-f</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> images <span class="token parameter variable">-aq</span><span class="token variable">)</span></span>

<span class="token comment">#强制删除镜像</span>
<span class="token function">docker</span> image <span class="token function">rm</span> 镜像名称/镜像ID

<span class="token comment">#保存镜像(将我们的镜像 保存为tar 压缩文件 这样方便镜像转移和保存 ,然后 可以在任何一台安装了docker的服务器上 加载这个镜像)</span>
<span class="token function">docker</span> save <span class="token parameter variable">-o</span> rocketmq.tar

<span class="token comment">#加载镜像(任何装 docker 的地方加载镜像保存文件,使其恢复为一个镜像)</span>
<span class="token function">docker</span> load <span class="token parameter variable">--input</span> rocketmq.tar 或 <span class="token function">docker</span> load <span class="token operator">&lt;</span> rocketmq.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-1、文件" tabindex="-1"><a class="header-anchor" href="#_4-1、文件" aria-hidden="true">#</a> 4.1、文件</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#文件映射</span>
<span class="token function">docker</span> run <span class="token parameter variable">-v</span> /etc/config:/etc/config my_image

<span class="token comment">#文件cp</span>
<span class="token function">docker</span> <span class="token function">cp</span> /mnt/c/Users/wxx/Downloads/kafka_2.12-2.1.2.tar.gz 64222xxx110:/usr/local/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2、容器" tabindex="-1"><a class="header-anchor" href="#_4-2、容器" aria-hidden="true">#</a> 4.2、容器</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#查看正在运行的容器列表</span>
<span class="token function">docker</span> <span class="token function">ps</span>

<span class="token comment">#查看所有容器</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>

<span class="token comment">#创建并启动容器</span>
<span class="token operator">&gt;</span> <span class="token function">docker</span> run <span class="token parameter variable">-itd</span> <span class="token parameter variable">--name</span><span class="token operator">=</span>kylin-test <span class="token parameter variable">--net</span><span class="token operator">=</span>host kylin-os-backup:latest /bin/bash

<span class="token comment">#停用</span>
<span class="token function">docker</span> stop xxxx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5、dockerfile" tabindex="-1"><a class="header-anchor" href="#_5、dockerfile" aria-hidden="true">#</a> 5、Dockerfile</h2><h3 id="_5-1、本地文件" tabindex="-1"><a class="header-anchor" href="#_5-1、本地文件" aria-hidden="true">#</a> 5.1、本地文件</h3><h4 id="_5-1-1、创建dockerfile项目" tabindex="-1"><a class="header-anchor" href="#_5-1-1、创建dockerfile项目" aria-hidden="true">#</a> 5.1.1、创建dockerfile项目</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">mkdir</span> redis <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> redis
$ <span class="token function">touch</span> Dockerfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>FROM centos
RUN yum -y install wget \\
    &amp;&amp; wget -O redis.tar.gz &quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot; \\
    &amp;&amp; tar -xvf redis.tar.gz \\
    &amp;&amp; rm redis.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-1-2、构建" tabindex="-1"><a class="header-anchor" href="#_5-1-2、构建" aria-hidden="true">#</a> 5.1.2、构建</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> redis:test <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_5-1-3、运行" tabindex="-1"><a class="header-anchor" href="#_5-1-3、运行" aria-hidden="true">#</a> 5.1.3、运行</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token parameter variable">--name</span> redis redis:test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-2、git构建" tabindex="-1"><a class="header-anchor" href="#_5-2、git构建" aria-hidden="true">#</a> 5.2、git构建</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> hello-world https://github.com/docker-library/hello-world.git<span class="token comment">#master:amd64/hello-world</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-3、标准输入构建" tabindex="-1"><a class="header-anchor" href="#_5-3、标准输入构建" aria-hidden="true">#</a> 5.3、标准输入构建</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> mybusybox:latest -<span class="token operator">&lt;&lt;</span><span class="token string">EOF
FROM busybox
RUN echo &quot;hello world&quot;
EOF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6、例子" tabindex="-1"><a class="header-anchor" href="#_6、例子" aria-hidden="true">#</a> 6、例子</h2><h3 id="_6-1、启动一个本地hadoop镜像" tabindex="-1"><a class="header-anchor" href="#_6-1、启动一个本地hadoop镜像" aria-hidden="true">#</a> 6.1、启动一个本地hadoop镜像</h3><p>下载image</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> pull sequenceiq/hadoop-docker:2.7.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>启动容器</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#后台运行</span>
<span class="token function">sudo</span> <span class="token function">docker</span> run <span class="token parameter variable">-dti</span> <span class="token parameter variable">--hostname</span> bigdatadev.host <span class="token punctuation">\\</span>
<span class="token parameter variable">-p</span> <span class="token number">50070</span>:50070 <span class="token parameter variable">-p</span> <span class="token number">9000</span>:9000 <span class="token parameter variable">-p</span> <span class="token number">8088</span>:8088 <span class="token parameter variable">-p</span> <span class="token number">8040</span>:8040 <span class="token parameter variable">-p</span> <span class="token number">8042</span>:8042 <span class="token parameter variable">-p</span> <span class="token number">49707</span>:49707 <span class="token punctuation">\\</span>
<span class="token parameter variable">-p</span> <span class="token number">50010</span>:50010 <span class="token parameter variable">-p</span> <span class="token number">50075</span>:50075 <span class="token parameter variable">-p</span> <span class="token number">50090</span>:50090 <span class="token parameter variable">-p</span> <span class="token number">2181</span>:2181 <span class="token parameter variable">-p</span> <span class="token number">9092</span>:9092 <span class="token punctuation">\\</span>
sequenceiq/hadoop-docker:2.7.0 /etc/bootstrap.sh <span class="token parameter variable">-bash</span> <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>hdfs-ui
http://localhost:50070/dfshealth.html#tab-overview

yarn-ui
http://localhost:8088/cluster/apps/RUNNING
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,28);function y(D,q){const l=r("router-link"),o=r("CodeTabs");return p(),u("div",null,[b,a("nav",h,[a("ul",null,[a("li",null,[s(l,{to:"#_1、docker是什么"},{default:e(()=>[n("1、Docker是什么？")]),_:1})]),a("li",null,[s(l,{to:"#_2、docker解决了什么问题"},{default:e(()=>[n("2、Docker解决了什么问题？")]),_:1}),a("ul",null,[a("li",null,[s(l,{to:"#_2-1、在docker诞生之前存在什么问题"},{default:e(()=>[n("2.1、在Docker诞生之前存在什么问题？")]),_:1})]),a("li",null,[s(l,{to:"#_2-2、docker的优点"},{default:e(()=>[n("2.2、Docker的优点：")]),_:1})])])]),a("li",null,[s(l,{to:"#_3、安装docker"},{default:e(()=>[n("3、安装docker")]),_:1})]),a("li",null,[s(l,{to:"#_4、docker命令"},{default:e(()=>[n("4、docker命令")]),_:1}),a("ul",null,[a("li",null,[s(l,{to:"#_4-1、image"},{default:e(()=>[n("4.1、image")]),_:1})]),a("li",null,[s(l,{to:"#_4-1、文件"},{default:e(()=>[n("4.1、文件")]),_:1})]),a("li",null,[s(l,{to:"#_4-2、容器"},{default:e(()=>[n("4.2、容器")]),_:1})])])]),a("li",null,[s(l,{to:"#_5、dockerfile"},{default:e(()=>[n("5、Dockerfile")]),_:1}),a("ul",null,[a("li",null,[s(l,{to:"#_5-1、本地文件"},{default:e(()=>[n("5.1、本地文件")]),_:1})]),a("li",null,[s(l,{to:"#_5-2、git构建"},{default:e(()=>[n("5.2、git构建")]),_:1})]),a("li",null,[s(l,{to:"#_5-3、标准输入构建"},{default:e(()=>[n("5.3、标准输入构建")]),_:1})])])]),a("li",null,[s(l,{to:"#_6、例子"},{default:e(()=>[n("6、例子")]),_:1}),a("ul",null,[a("li",null,[s(l,{to:"#_6-1、启动一个本地hadoop镜像"},{default:e(()=>[n("6.1、启动一个本地hadoop镜像")]),_:1})])])])])]),f,s(o,{id:"139",data:[{id:"ubuntu"},{id:"CentOS"}],"tab-id":"bash"},{title0:e(({value:i,isActive:c})=>[n("ubuntu")]),title1:e(({value:i,isActive:c})=>[n("CentOS")]),tab0:e(({value:i,isActive:c})=>[g]),tab1:e(({value:i,isActive:c})=>[_]),_:1}),x])}const O=d(v,[["render",y],["__file","Docker.html.vue"]]);export{O as default};
